## content
- FPS游戏简介


## 2 FPS游戏基础框架
关键元素？

- 武器
- 角色
- 游戏模式

### 技术角度
层次结构（从下往上）

- 系统
- 游戏引擎、第三方库
- 游戏系统
- 武器，3C，Gameplay

武器分类（按照分类：

- 步枪、狙击枪、手枪等（种类
- 近战，远程，投掷等。（装备类划分角度）
- 程序逻辑（InstantHit，Projectile）

## 3 Weapon System
关键组件

### 物理引擎
- 物理引擎（PhysX，Havok，Bullet？）
	- 使用物理引擎做什么？场景、移动，碰撞、受击检测等。
	- 角色布料模拟

### 弹道模型
- 不同的武器弹道不同，范围，画面
- 思考：什么影响了弹道？
	- 主视角角度
	- 后坐力
	- 连发数

拆解弹道模型
- 公式：子弹射出方向 = 主视角角度 + 后坐力 + 精准度 + 散发度
- 和具体的武器相关，可以通过配置参数
- 散发方向 = 随机数\*散发度\*水平/垂直方向

思考：去掉垂直后坐力的限制？
- 不断往上抬的效果

### InstantHit Weapon 开火流程
- 判断射程是否命中物体
	- 是：根据距离衰减和穿透衰减计算，产生伤害
	- 是否穿透？
		- 是
		- 否：根据连发数计算新的后坐力角度
	- 否：根据连发数计算新的后坐力角度
- 下一次射击

### 武器系统搭建
程序设计：

- 继承
- 组合

武器基类-其他继承组合

组件：Impact

- 武器弹孔，爆炸等贴画等

状态管理：状态机

- 状态本身也可以复用

## 4 3C system

3C的概念：

- Character：角色，有能力或者行为，玩家可以扮演或者观察
- Camera：相机，观察世界，获得体验感和沉浸感
- Control：控制，为玩家提供不同的方式。

### Charater技术要点

- 表现方面
	- Mesh贴图
	- 材质
	- 物理设置（盒子？）


- 逻辑方面
- 角色状态的设计和转换（UE已经实现）
- 细节问题：
	- 滑步（走动，转向）

### Camera技术要点

- 渲染顺序：
	- 穿模问题（一种可能的解决方法，限制最大碰撞盒子？）
- FOV（画面信息的范围）
	- UE的限制，整个渲染就是一个FOV
- 碰撞、位置控制
	- 例子：观战不是自己在操作，沉浸感问题
- 屏幕效果
	- 例子：震撼弹，血量濒危等

### Control技术要点

- 设备和手感
	- 例子：第一个手机端FPS的设计
		- IOS和Android适配灵敏度等
- 辅助瞄准
	- 帮忙做吸附
- 硬件功能
	- 3D touch功能
	- 陀螺仪等

## 5 其他技术点

### 网络同步
- 帧同步，状态同步
	- 帧同步：强一致，落网实时性较差，安全性较差（很多在客户端计算的逻辑）
	- 状态同步：流量消耗较高。安全性较强（很多在服务器计算的逻辑）。
- 客户端预表现 or 等服务器确认

### Peeker's Avantage
移动者会先看到静止者
可以看看拳头的技术文章。【Peeking into VALORANT‘s Notcode】

### 反外挂
外挂种类

- 定制外挂
- 通用工具
	- 内存修改器
	- 变速器
	- 抓包工具
- 辅助类
	- 按键精灵
	- 模拟器
	- 虚拟机
- 破解版
	- 脱机挂
	- 破解版客户端

外挂原理

- 应用层
- 系统层
- 硬件层

客户端数据加密

客户端动态监测

### 性能优化
使用物理引擎本身的开销很大，只需要使用包围盒的数据即可。

动画位置，通过LOD的手段进行计算。距离比较长- ，减少tick的频率。

GPU Skinning: 使用GPU的思路进行优化。

渲染：视锥，距离，LOD，遮挡剔除。